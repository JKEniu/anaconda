# Generated by Anaconda 40.22.3
# Generated by pykickstart v3.52
#version=DEVEL
# Use graphical install
graphical

# Keyboard layouts
keyboard --vckeymap=pl --xlayouts='pl'
# System language
lang pl_PL.UTF-8

%packages
@^server-product-environment
moby-engine
%end

# Run the Setup Agent on first boot
firstboot --enable

# Generated using Blivet version 3.7.1
ignoredisk --only-use=sda
autopart

# System timezone
timezone Europe/Warsaw --utc

#Root password
rootpw --iscrypted --allow-ssh $y$j9T$IURHIcUSBQSQmKX.tr0r8eza$CseM1Lf bqT. GmfnAxR8kdKOROZURtBUnraQjTA3/Uw1
user --groups-wheel --name=kuba --password=$y$j9T$XOROS1gtywnakzwd8PSOMAN. $3X6wk9w6ZTzg.jxiZBJhSP jBaJ9JXsJBG94J50/ry4X4 --iscrypted --gecos="Kuba"

#Repositories
url --mirrorlist=http://mirrors.fedoraproject.org/mirrorlist?repo-fedora-48&arch-x86_64
repo --name-update --mirrorlist=http://mirrors.fedoraproject.org/mirrorlist?repo-update-released-f40&arch=x86_64


#Format 
clearpart -all

%post--erroronfail
cat << 'EOF' > /etc/systemd/system/my-docker.service

usermod -aG docker root
systemctl enable docker

[Unit]
Description=Download docker and run
Requires=docker.service
After=docker.service

[Service]
Type=oneshot
RemainAfterExit=yes
ExecStart=/usr/bin/docker pull jkeniu/tetris: $(env.BUILD_NUMBER} 
ExecStart=/usr/bin/docker run --name tetris jkeniu/tetris

[Install]
WantedBy-multi-user.target
EOF

systemctl daemon-reloaded
systemctl enable my-docker.service 
systemctl start my-docker.service

%end
